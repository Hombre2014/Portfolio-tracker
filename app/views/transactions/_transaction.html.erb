<div id="<%= dom_id transaction %>" class="flex flex-col">
  <tr>
    <% transaction.commission == nil ? transaction.commission = 0 : transaction.commission %>
    <% transaction.fee == nil ? transaction.fee = 0 : transaction.fee %>
    <% added_cost = transaction.commission + transaction.fee %>
    <% transaction_amount = transaction.quantity * transaction.price %>
    <td class="border border-slate-300 px-4"><%= transaction.tr_type %></td>
    <td class="border border-slate-300 px-4"><%= transaction.trade_date %></td>
    <td class="border border-slate-300 px-4"><%= transaction.symbol %></td>
    <td class="border border-slate-300 px-4"><%= transaction.quantity %></td>
    <td class="border border-slate-300 px-4"><%= number_to_currency(transaction.price) %></td>
    <td class="border border-slate-300 px-4"><%= number_to_currency(transaction.commission) %></td>
    <% @total_commissions += transaction.commission %>
    <td class="border border-slate-300 px-4"><%= number_to_currency(transaction.fee) %></td>
    <% @total_fees += transaction.fee %>
    <% if transaction.tr_type == 'Buy' %>
      <td class="border border-slate-300 px-4 text-red-600">-<%= number_to_currency(transaction_amount + added_cost) %></td>
      <% @income_spent -= transaction_amount + added_cost %>
    <% else %>
      <td class="border border-slate-300 px-4 text-green-600"><%= number_to_currency(transaction_amount - added_cost) %></td>
      <% @income_spent += transaction_amount - added_cost %>
    <% end %>
    <% if action_name != "show" %>
      <td class="border border-slate-300 px-4"><%= link_to "Show", "/users/#{current_user.id}/portfolios/#{params[:portfolio_id]}/transactions/#{transaction.id}", class: "rounded-lg py-1 px-3 bg-cyan-300 block font-medium" %></td>
      <td class="border border-slate-300 px-4"><%= link_to 'Edit', "/users/#{current_user.id}/portfolios/#{params[:portfolio_id]}/transactions/#{transaction.id}/edit", class: "rounded-lg py-1 ml-2 px-3 bg-cyan-500 inline-block font-medium" %></td>
    <% end %>
  </tr>
</div>
